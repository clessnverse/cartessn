% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils.R
\name{map_fsa_to_ridings}
\alias{map_fsa_to_ridings}
\title{Map Forward Sortation Areas (FSAs) to Electoral Ridings}
\usage{
map_fsa_to_ridings(
  sf_rta,
  sf_ridings,
  min_intersection_pct = 10,
  simplify_geometries = TRUE,
  tolerance = 50,
  force_all_fsa_match = FALSE
)
}
\arguments{
\item{sf_rta}{An \code{sf} object containing FSA (RTA in French) geometries. Should have a column
named 'rta' containing the FSA codes.}

\item{sf_ridings}{An \code{sf} object containing electoral riding geometries. Should have a column
named 'id_riding' containing the riding identifiers.}

\item{min_intersection_pct}{Minimum percentage of FSA area that must be covered by a riding
to be considered for mapping. Lower values may include more mappings but with lower confidence.
Default is 10 (10\%).}

\item{simplify_geometries}{Logical indicating whether to simplify geometries before intersection
for better performance. Default is TRUE.}

\item{tolerance}{Simplification tolerance when simplify_geometries is TRUE. Default is 50.}

\item{force_all_fsa_match}{Logical indicating if FSAs with no major riding intersection should be
assigned to the largest intersection regardless of size. Default is FALSE.}
}
\value{
A list containing three dataframes:
\describe{
\item{fsa_riding_intersections}{A complete dataframe of all FSA-Riding intersections with areas and percentages}
\item{fsa_to_riding_mapping}{A simplified mapping with each FSA mapped to its most overlapping riding}
\item{summary}{A summary of match statistics}
}
}
\description{
This function creates a mapping between Forward Sortation Areas (FSAs, the first 3 characters
of a Canadian postal code) and electoral ridings. It handles topological issues and ensures
that the output is valid for map visualizations and other analyses.
}
\details{
\itemize{
\item This function addresses common topological issues with spatial data
\item It calculates the intersection between FSAs and electoral ridings
\item For each FSA, it identifies the riding with the largest intersection
\item The return value includes both detailed intersections and a simplified mapping
}
}
\examples{
\dontrun{
# Load spatial data
sf_rta <- cartessn::spatial_canada_2021_rta
sf_ridings <- cartessn::spatial_canada_2022_electoral_ridings_aligned

# Create the mapping
mapping <- map_fsa_to_ridings(sf_rta, sf_ridings)

# Access the simplified mapping
fsa_riding_map <- mapping$fsa_to_riding_mapping

# Join with survey data
survey_data$id_riding <- fsa_riding_map$id_riding[match(survey_data$postal_code_prefix, fsa_riding_map$rta)]
}

}
