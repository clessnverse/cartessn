% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/predict_spatial_target_from_origin.R
\name{predict_spatial_target}
\alias{predict_spatial_target}
\title{Prédire une unité spatiale cible à partir d'unité d'origine et de variables SES}
\usage{
predict_spatial_target(
  survey_data,
  origin_col = "rta",
  target_col = "id_riding",
  ses_vars,
  census_origin,
  census_target,
  spatial_origin,
  spatial_target,
  return_type = c("probabilities", "class"),
  n_sim = 500
)
}
\arguments{
\item{survey_data}{Données du sondage. Doit contenir uniquement \code{origin_col} et les variables listées dans \code{ses_vars}.}

\item{origin_col}{Nom de la colonne dans \code{survey_data} identifiant l’unité spatiale d’origine (ex: \code{"rta"}).}

\item{target_col}{Nom de l’unité spatiale à prédire (ex: \code{"id_riding"}).}

\item{ses_vars}{Vecteur de noms de variables SES présentes dans \code{survey_data} et dans les colonnes \code{variable} des recensements.}

\item{census_origin}{Données de recensement par unité d'origine. Format long avec colonnes \code{variable}, \code{category}, \code{count}, \code{prop}.}

\item{census_target}{Données de recensement par unité cible. Même format que \code{census_origin}.}

\item{spatial_origin}{Objet \code{sf} représentant les unités spatiales d’origine (ex: RTAs).}

\item{spatial_target}{Objet \code{sf} représentant les unités spatiales cibles (ex: circonscriptions).}

\item{return_type}{Type de sortie : \code{"probabilities"} (matrice avec une colonne par cible) ou \code{"class"} (vecteur des classes les plus probables).}

\item{n_sim}{Nombre de répondants à simuler par unité d'origine.}
}
\value{
Un \code{data.frame} avec une ligne par répondant :
\itemize{
\item Si \code{return_type = "probabilities"} : une matrice de probabilités (1 ligne x N cibles).
\item Si \code{return_type = "class"} : un vecteur de classes (\code{target_col}) avec la classe la plus probable.
}
}
\description{
Cette fonction entraîne un modèle multinomial pour chaque unité d'origine à partir de données simulées
(ou applique une correspondance unique si l'unité n'est liée qu'à une seule cible).
Elle retourne soit une matrice de probabilités, soit un vecteur des classes les plus probables.
}
\details{
Cette fonction effectue plusieurs validations :
\itemize{
\item \code{survey_data} ne doit contenir que \code{origin_col} et les variables spécifiées dans \code{ses_vars}.
\item Les recensements doivent être au format long avec les colonnes : \code{variable}, \code{category}, \code{count}, \code{prop}.
\item Toutes les SES doivent apparaître dans les colonnes \code{variable} des deux recensements.
\item Toutes les catégories présentes dans \code{survey_data} doivent être présentes dans les recensements.
\item Le nombre d'unités spatiales dans les objets \code{sf} doit correspondre à celui dans les recensements.
}
}
